(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{3431:(e,t,s)=>{Promise.resolve().then(s.bind(s,7626))},7626:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),i=s(2115);s(8813);var r=s(6995);class n{async ensureLoaded(){return this.ranges?this.ranges:(this.loadingPromise||(this.loadingPromise=this.loadDatabase()),this.loadingPromise)}async loadDatabase(){let e=await fetch(this.databasePath);if(!e.ok)throw Error("Failed to load IP country database: ".concat(e.status," ").concat(e.statusText));let t=await e.text(),s=this.parseDatabase(t);return this.ranges=s,s}parseDatabase(e){let t=e.split(/\r?\n/),s=[];for(let e of t){if(!e)continue;let[t,a,i]=e.split(",");if(!t||!a||!i)continue;let r=this.ipToInteger(t.trim()),n=this.ipToInteger(a.trim()),l=i.trim();null===r||null===n||r>n||s.push({start:r,end:n,country:l})}return s.sort((e,t)=>e.start-t.start),s}ipToInteger(e){if(!e)return null;let t=e.split(".");if(4!==t.length)return null;let s=0;for(let e of t){if(""===e)return null;let t=Number.parseInt(e,10);if(Number.isNaN(t)||t<0||t>255)return null;s=256*s+t}return s}findCountry(e){if(!e)return null;if(!this.ranges)throw Error("IP country data not loaded. Call ensureLoaded() first.");let t=this.ipToInteger(e);if(null===t)return null;let s=0,a=this.ranges.length-1;for(;s<=a;){let e=Math.floor((s+a)/2),i=this.ranges[e];if(t<i.start)a=e-1;else{if(!(t>i.end))return i.country;s=e+1}}return null}constructor(e="/dbip-country-ipv4.csv"){this.databasePath=e,this.ranges=null,this.loadingPromise=null}}new n;class l{getNewStatBlock(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{totalEntries:0,uniqueUrls:new Set,statusCodes:{},totalBytes:0,botRequests:0,humanRequests:0,uniqueBots:new Set,botsByType:{},botStats:{},urlCounts:{},ipCounts:{},minDate:null,maxDate:null,botUrlHits:{},humanReferrers:{},countryCounts:{},entries:e?[]:void 0}}initializeBotPatterns(){return{seo:[{name:"Googlebot",pattern:/googlebot|^google$/i,company:"Google"},{name:"Bingbot",pattern:/bingbot/i,company:"Microsoft"},{name:"Slurp",pattern:/slurp/i,company:"Yahoo"},{name:"DuckDuckBot",pattern:/duckduckbot/i,company:"DuckDuckGo"},{name:"Baiduspider",pattern:/baiduspider/i,company:"Baidu"},{name:"YandexBot",pattern:/yandexbot/i,company:"Yandex"},{name:"Sogou",pattern:/sogou/i,company:"Sogou"},{name:"Exabot",pattern:/exabot/i,company:"Exalead"},{name:"facebookexternalhit",pattern:/facebookexternalhit/i,company:"Facebook"},{name:"Twitterbot",pattern:/twitterbot/i,company:"Twitter"},{name:"LinkedInBot",pattern:/linkedinbot/i,company:"LinkedIn"},{name:"WhatsApp",pattern:/whatsapp/i,company:"WhatsApp"},{name:"Applebot",pattern:/applebot/i,company:"Apple"},{name:"MJ12bot",pattern:/mj12bot/i,company:"Majestic"},{name:"AhrefsBot",pattern:/ahrefsbot/i,company:"Ahrefs"},{name:"SemrushBot",pattern:/semrushbot/i,company:"Semrush"},{name:"MozBot",pattern:/rogerbot|dotbot/i,company:"Moz"}],ai:[{name:"GPTBot",pattern:/gptbot/i,company:"OpenAI"},{name:"ChatGPT-User",pattern:/chatgpt-user/i,company:"OpenAI"},{name:"CCBot",pattern:/ccbot/i,company:"Common Crawl"},{name:"Claude-Web",pattern:/claude-web/i,company:"Anthropic"},{name:"PerplexityBot",pattern:/perplexitybot/i,company:"Perplexity"},{name:"YouBot",pattern:/youbot/i,company:"You.com"},{name:"AI2Bot",pattern:/ai2bot/i,company:"AI2"},{name:"ImagesiftBot",pattern:/imagesiftbot/i,company:"ImageSift"},{name:"Omgilibot",pattern:/omgilibot/i,company:"Omgili"},{name:"Bytespider",pattern:/bytespider/i,company:"ByteDance"},{name:"MetaExternalAgent ",pattern:/meta-externalagent/i,company:"Meta"}],social:[{name:"FacebookBot",pattern:/facebookbot/i,company:"Facebook"},{name:"TelegramBot",pattern:/telegrambot/i,company:"Telegram"},{name:"SkypeUriPreview",pattern:/skypeuripreview/i,company:"Skype"},{name:"SlackBot",pattern:/slackbot/i,company:"Slack"},{name:"DiscordBot",pattern:/discordbot/i,company:"Discord"},{name:"RedditBot",pattern:/redditbot/i,company:"Reddit"},{name:"PinterestBot",pattern:/pinterestbot/i,company:"Pinterest"}],monitoring:[{name:"UptimeRobot",pattern:/uptimerobot/i,company:"UptimeRobot"},{name:"Pingdom",pattern:/pingdom/i,company:"Pingdom"},{name:"StatusCake",pattern:/statuscake/i,company:"StatusCake"},{name:"Site24x7",pattern:/site24x7/i,company:"Site24x7"},{name:"GTmetrix",pattern:/gtmetrix/i,company:"GTmetrix"},{name:"PageSpeed",pattern:/pagespeed/i,company:"Google PageSpeed"}],security:[{name:"Nessus",pattern:/nessus/i,company:"Tenable"},{name:"Nikto",pattern:/nikto/i,company:"Nikto"},{name:"Nmap",pattern:/nmap/i,company:"Nmap"},{name:"Qualys",pattern:/qualys/i,company:"Qualys"},{name:"OpenVAS",pattern:/openvas/i,company:"OpenVAS"},{name:"ZAP",pattern:/zap/i,company:"OWASP ZAP"}],other:[{name:"Wget",pattern:/wget/i,company:"GNU Wget"},{name:"Curl",pattern:/curl/i,company:"cURL"},{name:"Python-requests",pattern:/python-requests/i,company:"Python"},{name:"Go-http-client",pattern:/go-http-client/i,company:"Go"},{name:"Java",pattern:/java/i,company:"Java"},{name:"Node.js",pattern:/node/i,company:"Node.js"},{name:"Scrapy",pattern:/scrapy/i,company:"Scrapy"},{name:"Headless Chrome",pattern:/headlesschrome/i,company:"Chrome"},{name:"DownNotifier",pattern:/downnotifier/i,company:"DownNotifier"},{name:"BetterUptime",pattern:/betteruptime|better uptime/i,company:"Better Uptime"},{name:"HubSpotPageFetcher",pattern:/hubspotpagefetcher|HubSpot Page Fetcher/i,company:"HubSpot"},{name:"AdsBot Google Mobile",pattern:/adsbot-google-mobile/i,company:"Google"},{name:"AdsBot Google",pattern:/adsbot-google/i,company:"Google"},{name:"Google-Adwords-Instant",pattern:/google-adwords-instant/i,company:"Google"}]}}initializeEventListeners(){let e=document.getElementById("logFile"),t=document.getElementById("analyzeBtn"),s=document.getElementById("dropbox"),a=document.getElementById("fileListContainer"),i=document.getElementById("clearData"),r=document.getElementById("applyDateRange"),n=document.getElementById("resetDateRange"),l=document.querySelectorAll(".quick-filter-btn"),o=document.getElementById("countryFilterDropdown"),c=document.getElementById("countryFilterDisplay"),d=document.getElementById("countryFilterOptions"),u=document.getElementById("countryFilterSearch"),m=document.getElementById("countryFilterCheckboxes"),h=document.getElementById("applyCountryFilter"),p=document.getElementById("resetCountryFilter"),y=document.getElementById("applyIpFilter"),g=document.getElementById("resetIpFilter"),x=document.getElementById("ipFilterDropdown"),b=document.getElementById("ipFilterDisplay"),f=document.getElementById("ipFilterOptions"),v=document.getElementById("ipFilterSearch"),j=document.getElementById("ipFilterList"),C=document.getElementById("exportIpFilterResults"),B=document.getElementById("showComparison"),E=document.getElementById("hideComparison"),D=document.getElementById("runComparison"),S=document.querySelectorAll(".preset-btn"),F=document.getElementById("botUrlFilterDropdown"),N=document.getElementById("botUrlFilterDisplay"),I=document.getElementById("botUrlFilterOptions"),T=document.getElementById("referrerFilterDropdown"),L=document.getElementById("referrerFilterDisplay"),A=document.getElementById("referrerFilterOptions"),R=document.getElementById("compBotFilterDropdown"),w=document.getElementById("compBotFilterDisplay"),k=document.getElementById("compBotFilterOptions"),M=document.getElementById("compReferrerFilterDropdown"),H=document.getElementById("compReferrerFilterDisplay"),U=document.getElementById("compReferrerFilterOptions"),q=document.getElementById("botFilterSearch"),P=document.getElementById("referrerFilterSearch"),O=document.getElementById("compBotFilterSearch"),z=document.getElementById("compReferrerFilterSearch"),G=document.getElementById("botUrlFilterCheckboxes"),Z=document.getElementById("referrerFilterCheckboxes"),W=document.getElementById("compBotFilterCheckboxes"),V=document.getElementById("compReferrerFilterCheckboxes"),$=document.getElementById("rejectionModal"),J=document.getElementById("closeRejectionModal"),_=document.getElementById("addRejectionRule"),Y=document.getElementById("rejectionRulesContainer"),Q=document.getElementById("confirmRejectionAndAnalyze"),K=document.getElementById("analyzeWithoutRejection");e.addEventListener("change",e=>this.addFiles(e.target.files)),s.addEventListener("click",()=>e.click()),s.addEventListener("dragover",e=>{e.preventDefault(),s.classList.add("dragover")}),s.addEventListener("dragleave",e=>{e.preventDefault(),s.classList.remove("dragover")}),s.addEventListener("drop",e=>{e.preventDefault(),s.classList.remove("dragover"),e.dataTransfer.files.length>0&&this.addFiles(e.dataTransfer.files)}),a.addEventListener("click",e=>{if(e.target.classList.contains("remove-file")){e.stopPropagation();let t=Number.parseInt(e.target.dataset.index,10);this.removeFile(t)}}),t.addEventListener("click",()=>{$.classList.remove("hidden")}),i.addEventListener("click",()=>this.clearAllData()),r.addEventListener("click",()=>this.applyDateFilter()),n.addEventListener("click",()=>this.resetDateFilter()),l.forEach(e=>{e.addEventListener("click",e=>{let t=Number.parseInt(e.target.dataset.days);this.applyQuickFilter(t)})}),c&&d&&(c.addEventListener("click",()=>d.classList.toggle("visible")),d.addEventListener("click",e=>{e.target.matches('[data-action="select-all"]')&&d.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.matches('[data-action="deselect-all"]')&&d.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.updateMultiSelectDisplayText("country")}),d.addEventListener("change",()=>this.updateMultiSelectDisplayText("country"))),h&&h.addEventListener("click",()=>this.applyCountryFilter()),p&&p.addEventListener("click",()=>this.resetCountryFilter()),y&&y.addEventListener("click",()=>this.applyIpFilter()),g&&g.addEventListener("click",()=>this.resetIpFilter()),C&&C.addEventListener("click",()=>this.exportIpFilterResults()),b&&f&&b.addEventListener("click",()=>f.classList.toggle("visible")),f&&f.addEventListener("change",e=>{if(e.target.matches('input[type="radio"]')){let t=e.target.value;this.updateIpFilterDropdownSelection(t),this.applyIpFilter(),f.classList.remove("visible")}}),B.addEventListener("click",()=>this.showComparison()),E.addEventListener("click",()=>this.hideComparison()),D.addEventListener("click",()=>this.runComparison()),S.forEach(e=>{e.addEventListener("click",e=>{let t=e.target.dataset.period,s=Number.parseInt(e.target.dataset.days);this.applyPreset(t,s)})}),N.addEventListener("click",()=>I.classList.toggle("visible")),I.addEventListener("click",e=>{e.target.matches('[data-action="select-all"]')&&I.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.matches('[data-action="deselect-all"]')&&I.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.updateMultiSelectDisplayText("bot"),this.createBotUrlHitsTable(this.currentAnalysis.botUrlHits)}),L.addEventListener("click",()=>A.classList.toggle("visible")),A.addEventListener("click",e=>{e.target.matches('[data-action="select-all"]')&&A.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.matches('[data-action="deselect-all"]')&&A.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.updateMultiSelectDisplayText("referrer"),this.createTrafficSourceTable(this.currentAnalysis.humanReferrers)}),w&&(w.addEventListener("click",()=>k.classList.toggle("visible")),k.addEventListener("click",e=>{e.target.matches('[data-action="select-all"]')&&k.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.matches('[data-action="deselect-all"]')&&k.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.updateMultiSelectDisplayText("compBot"),this.comparisonData&&this.createComparisonBotHitsTable()})),H&&(H.addEventListener("click",()=>U.classList.toggle("visible")),U.addEventListener("click",e=>{e.target.matches('[data-action="select-all"]')&&U.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.matches('[data-action="deselect-all"]')&&U.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.updateMultiSelectDisplayText("compReferrer"),this.comparisonData&&this.createComparisonTrafficSourcesTable()})),J.addEventListener("click",()=>$.classList.add("hidden")),K.addEventListener("click",()=>{this.rejectionPatterns=[],$.classList.add("hidden"),this.analyzeLogFile()}),Q.addEventListener("click",()=>{let e=Y.querySelectorAll("input");this.rejectionPatterns=Array.from(e).map(e=>e.value.trim()).filter(e=>""!==e),$.classList.add("hidden"),this.analyzeLogFile()}),_.addEventListener("click",()=>{this.addRejectionRuleRow()}),Y.addEventListener("click",e=>{e.target.classList.contains("remove-rule-btn")&&e.target.closest(".rejection-rule-row").remove()}),this.setupFilterSearch(q,G),this.setupFilterSearch(P,Z),u&&m&&this.setupFilterSearch(u,m),v&&j&&this.setupIpFilterSearch(v,j),O&&this.setupFilterSearch(O,W),z&&this.setupFilterSearch(z,V),window.addEventListener("click",e=>{F.contains(e.target)||I.classList.remove("visible"),T.contains(e.target)||A.classList.remove("visible"),o&&d&&!o.contains(e.target)&&d.classList.remove("visible"),R&&!R.contains(e.target)&&k.classList.remove("visible"),M&&!M.contains(e.target)&&U.classList.remove("visible"),x&&f&&!x.contains(e.target)&&f.classList.remove("visible")})}showComparison(){if(!this.fullFileAnalysis)return void alert("Please analyze log files first before comparing periods.");document.getElementById("comparisonSection").classList.remove("hidden"),this.setupComparisonDateInputs()}hideComparison(){document.getElementById("comparisonSection").classList.add("hidden"),document.getElementById("comparisonResults").classList.add("hidden"),this.destroyComparisonCharts(),this.comparisonData=null}setupComparisonDateInputs(){let e=this.fullFileAnalysis.minDate.toISOString().split("T")[0],t=this.fullFileAnalysis.maxDate.toISOString().split("T")[0],s=document.getElementById("periodAStart"),a=document.getElementById("periodAEnd"),i=document.getElementById("periodBStart"),r=document.getElementById("periodBEnd");[s,a,i,r].forEach(s=>{s.min=e,s.max=t});let n=new Date(this.fullFileAnalysis.maxDate),l=new Date(n),o=new Date(n);o.setUTCDate(o.getUTCDate()-6);let c=new Date(o);c.setUTCDate(c.getUTCDate()-1);let d=new Date(c);d.setUTCDate(d.getUTCDate()-6),s.value=o.toISOString().split("T")[0],a.value=l.toISOString().split("T")[0],i.value=d.toISOString().split("T")[0],r.value=c.toISOString().split("T")[0]}applyPreset(e,t){let s=new Date(this.fullFileAnalysis.maxDate);if("A"===e){let e=new Date(s),a=new Date(s);a.setUTCDate(a.getUTCDate()-(t-1)),document.getElementById("periodAStart").value=a.toISOString().split("T")[0],document.getElementById("periodAEnd").value=e.toISOString().split("T")[0]}else{let e=new Date(new Date(document.getElementById("periodAStart").value+"T00:00:00.000Z"));e.setUTCDate(e.getUTCDate()-1);let s=new Date(e);s.setUTCDate(s.getUTCDate()-(t-1)),document.getElementById("periodBStart").value=s.toISOString().split("T")[0],document.getElementById("periodBEnd").value=e.toISOString().split("T")[0]}}runComparison(){let e=new Date(document.getElementById("periodAStart").value+"T00:00:00.000Z"),t=new Date(document.getElementById("periodAEnd").value+"T00:00:00.000Z"),s=new Date(document.getElementById("periodBStart").value+"T00:00:00.000Z"),a=new Date(document.getElementById("periodBEnd").value+"T00:00:00.000Z");if(t<e||a<s)return void alert("End dates cannot be earlier than start dates.");let i=this.aggregateStatsForRange(e,t,{countryFilter:this.countryFilter}),r=this.aggregateStatsForRange(s,a,{countryFilter:this.countryFilter});this.comparisonData={periodA:i,periodB:r},this.displayComparisonResults(i,r)}displayComparisonResults(e,t){document.getElementById("comparisonResults").classList.remove("hidden");let s=Math.ceil((e.maxDate-e.minDate)/864e5)+1,a=Math.ceil((t.maxDate-t.minDate)/864e5)+1;document.getElementById("periodADates").textContent="".concat(e.minDate.toLocaleDateString()," - ").concat(e.maxDate.toLocaleDateString()),document.getElementById("periodADuration").textContent="".concat(s," days"),document.getElementById("periodBDates").textContent="".concat(t.minDate.toLocaleDateString()," - ").concat(t.maxDate.toLocaleDateString()),document.getElementById("periodBDuration").textContent="".concat(a," days"),this.updateComparisonMetric("compTotalRequests",e.totalEntries,t.totalEntries),this.updateComparisonMetric("compUniqueUrls",e.uniqueUrls.size,t.uniqueUrls.size),this.updateComparisonMetric("compBotTraffic",e.botRequests,t.botRequests),this.updateComparisonMetric("compHumanTraffic",e.humanRequests,t.humanRequests),this.updateComparisonMetric("compTotalBytes",e.totalBytes,t.totalBytes,!0);let i=e.totalEntries>0?((e.statusCodes[4]||0)+(e.statusCodes[5]||0))/e.totalEntries*100:0,r=t.totalEntries>0?((t.statusCodes[4]||0)+(t.statusCodes[5]||0))/t.totalEntries*100:0;document.getElementById("compErrorRateA").textContent="".concat(i.toFixed(1),"%"),document.getElementById("compErrorRateB").textContent="".concat(r.toFixed(1),"%");let n=0!==r?(i-r)/r*100:0;this.updateChangeIndicator("compErrorRateChange",n,!0),this.createComparisonCharts(e,t),this.setupComparisonTableFilters(e,t),this.createComparisonBotHitsTable(),this.createComparisonTrafficSourcesTable()}setupComparisonTableFilters(e,t){let s=new Set;Object.keys(e.botStats).forEach(e=>s.add(e)),Object.keys(t.botStats).forEach(e=>s.add(e));let a=new Set;for(let t in e.humanReferrers)Object.keys(e.humanReferrers[t]).forEach(e=>a.add(e));for(let e in t.humanReferrers)Object.keys(t.humanReferrers[e]).forEach(e=>a.add(e));this.populateComparisonBotFilter(Array.from(s)),this.populateComparisonReferrerFilter(Array.from(a))}populateComparisonBotFilter(e){let t=document.getElementById("compBotFilterCheckboxes");if(!t)return;if(t.innerHTML="",0===e.length)return void this.updateMultiSelectDisplayText("compBot");let s=e.sort((e,t)=>{var s,a,i,r;let n=((null==(s=this.comparisonData.periodA.botStats[e])?void 0:s.count)||0)+((null==(a=this.comparisonData.periodB.botStats[e])?void 0:a.count)||0);return((null==(i=this.comparisonData.periodA.botStats[t])?void 0:i.count)||0)+((null==(r=this.comparisonData.periodB.botStats[t])?void 0:r.count)||0)-n}),a=s.slice(0,10);s.forEach(e=>{let s=document.createElement("label"),i=document.createElement("input");i.type="checkbox",i.value=e,i.checked=a.includes(e);let r=document.createTextNode(" ".concat(e));s.appendChild(i),s.appendChild(r),t.appendChild(s)}),this.updateMultiSelectDisplayText("compBot")}populateComparisonReferrerFilter(e){let t=document.getElementById("compReferrerFilterCheckboxes");if(!t)return;if(t.innerHTML="",0===e.length)return void this.updateMultiSelectDisplayText("compReferrer");let s=e.sort((e,t)=>"Direct"===e?-1:"Direct"===t?1:e.localeCompare(t)),a=s.slice(0,6);s.forEach(e=>{let s=document.createElement("label"),i=document.createElement("input");i.type="checkbox",i.value=e,i.checked=a.includes(e);let r=document.createTextNode(" ".concat(e));s.appendChild(i),s.appendChild(r),t.appendChild(s)}),this.updateMultiSelectDisplayText("compReferrer")}createComparisonBotHitsTable(){let e=document.querySelector("#comparisonBotHitsTable thead"),t=document.querySelector("#comparisonBotHitsTable tbody");if(!e||!t||!this.comparisonData)return;e.innerHTML="",t.innerHTML="";let s=Array.from(document.querySelectorAll("#compBotFilterCheckboxes input:checked")).map(e=>e.value);if(0===s.length){t.innerHTML='<tr class="table-placeholder"><td colspan="1">Select one or more bots to display comparison data.</td></tr>';return}let a=e.insertRow();a.innerHTML="<th>URL</th>",s.forEach(e=>{a.innerHTML+='<th colspan="3">'.concat(e,"</th>")});let i=e.insertRow();i.innerHTML="<th></th>",s.forEach(()=>{i.innerHTML+="<th>Period A</th><th>Period B</th><th>Change</th>"});let r=new Set;for(let e in this.comparisonData.periodA.botUrlHits)r.add(e);for(let e in this.comparisonData.periodB.botUrlHits)r.add(e);let n=[];for(let e of r){let t=0,a=0,i={};for(let r of s){var l,o;let s=(null==(l=this.comparisonData.periodA.botUrlHits[e])?void 0:l[r])||0,n=(null==(o=this.comparisonData.periodB.botUrlHits[e])?void 0:o[r])||0;t+=s,a+=n,i[r]={hitsA:s,hitsB:n}}(t>0||a>0)&&n.push({url:e,totalHitsA:t,totalHitsB:a,botData:i})}n.sort((e,t)=>t.totalHitsA+t.totalHitsB-(e.totalHitsA+e.totalHitsB));let c=n.slice(0,50);if(0===c.length){t.innerHTML='<tr class="table-placeholder"><td colspan="'.concat(3*s.length+1,'">No bot hits found for the selected bots in either period.</td></tr>');return}c.forEach(e=>{let a=t.insertRow(),i='<td title="'.concat(e.url,'">').concat(e.url.length>50?"".concat(e.url.substring(0,50),"..."):e.url,"</td>");s.forEach(t=>{let{hitsA:s,hitsB:a}=e.botData[t],r=0!==a?(s-a)/a*100:100*(s>0),n=.1>Math.abs(r)?"table-change-neutral":r>0?"table-change-positive":"table-change-negative";i+="<td>".concat(s.toLocaleString(),"</td>"),i+="<td>".concat(a.toLocaleString(),"</td>"),i+='<td class="'.concat(n,'">').concat(r>=0?"+":"").concat(r.toFixed(1),"%</td>")}),a.innerHTML=i})}createComparisonTrafficSourcesTable(){let e=document.querySelector("#comparisonTrafficSourcesTable thead"),t=document.querySelector("#comparisonTrafficSourcesTable tbody");if(!e||!t||!this.comparisonData)return;e.innerHTML="",t.innerHTML="";let s=Array.from(document.querySelectorAll("#compReferrerFilterCheckboxes input:checked")).map(e=>e.value);if(0===s.length){t.innerHTML='<tr class="table-placeholder"><td colspan="1">Select one or more referrers to display comparison data.</td></tr>';return}let a=e.insertRow();a.innerHTML="<th>URL</th>",s.forEach(e=>{a.innerHTML+='<th colspan="3">'.concat(e,"</th>")});let i=e.insertRow();i.innerHTML="<th></th>",s.forEach(()=>{i.innerHTML+="<th>Period A</th><th>Period B</th><th>Change</th>"});let r=new Set;for(let e in this.comparisonData.periodA.humanReferrers)r.add(e);for(let e in this.comparisonData.periodB.humanReferrers)r.add(e);let n=[];for(let e of r){let t=0,a=0,i={};for(let r of s){var l,o;let s=(null==(l=this.comparisonData.periodA.humanReferrers[e])?void 0:l[r])||0,n=(null==(o=this.comparisonData.periodB.humanReferrers[e])?void 0:o[r])||0;t+=s,a+=n,i[r]={hitsA:s,hitsB:n}}(t>0||a>0)&&n.push({url:e,totalHitsA:t,totalHitsB:a,referrerData:i})}n.sort((e,t)=>t.totalHitsA+t.totalHitsB-(e.totalHitsA+e.totalHitsB));let c=n.slice(0,50);if(0===c.length){t.innerHTML='<tr class="table-placeholder"><td colspan="'.concat(3*s.length+1,'">No traffic found from the selected referrers in either period.</td></tr>');return}c.forEach(e=>{let a=t.insertRow(),i='<td title="'.concat(e.url,'">').concat(e.url.length>50?"".concat(e.url.substring(0,50),"..."):e.url,"</td>");s.forEach(t=>{let{hitsA:s,hitsB:a}=e.referrerData[t],r=0!==a?(s-a)/a*100:100*(s>0),n=.1>Math.abs(r)?"table-change-neutral":r>0?"table-change-positive":"table-change-negative";i+="<td>".concat(s.toLocaleString(),"</td>"),i+="<td>".concat(a.toLocaleString(),"</td>"),i+='<td class="'.concat(n,'">').concat(r>=0?"+":"").concat(r.toFixed(1),"%</td>")}),a.innerHTML=i})}updateComparisonMetric(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=document.getElementById(e+"A"),r=document.getElementById(e+"B"),n=document.getElementById(e+"Change");a?(i.textContent=this.formatBytes(t),r.textContent=this.formatBytes(s)):(i.textContent=t.toLocaleString(),r.textContent=s.toLocaleString());let l=0!==s?(t-s)/s*100:0;this.updateChangeIndicator(n.id,l)}updateChangeIndicator(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=document.getElementById(e),i=Math.abs(t);a.textContent="".concat(t>=0?"+":"").concat(t.toFixed(1),"%"),a.classList.remove("positive","negative","neutral"),i<.1?a.classList.add("neutral"):t>0?a.classList.add(s?"negative":"positive"):a.classList.add(s?"positive":"negative")}createComparisonCharts(e,t){this.destroyComparisonCharts(),this.createComparisonTrafficChart(e,t),this.createComparisonBotChart(e,t)}createComparisonTrafficChart(e,t){let s=document.getElementById("comparisonTrafficChart").getContext("2d"),a=this.getDatesInRange(e.minDate,e.maxDate),i=this.getDatesInRange(t.minDate,t.maxDate),n=this.getDailyDataForRange(e.minDate,e.maxDate,this.countryFilter),l=this.getDailyDataForRange(t.minDate,t.maxDate,this.countryFilter),o=a.map(e=>{var t;return(null==(t=n[e.toISOString().split("T")[0]])?void 0:t.totalEntries)||0}),c=i.map(e=>{var t;return(null==(t=l[e.toISOString().split("T")[0]])?void 0:t.totalEntries)||0}),d=Array.from({length:Math.max(a.length,i.length)},(e,t)=>"Day ".concat(t+1));this.comparisonCharts.traffic=new r.Ay(s,{type:"line",data:{labels:d,datasets:[{label:"Period A",data:o,borderColor:"#3498db",backgroundColor:"rgba(52, 152, 219, 0.1)",tension:.1,fill:!1},{label:"Period B",data:c,borderColor:"#e74c3c",backgroundColor:"rgba(231, 76, 60, 0.1)",tension:.1,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}},plugins:{legend:{position:"top"}}}})}createComparisonBotChart(e,t){let s=document.getElementById("comparisonBotChart").getContext("2d");this.comparisonCharts.bot=new r.Ay(s,{type:"bar",data:{labels:["Bot Traffic","Human Traffic"],datasets:[{label:"Period A",data:[e.botRequests,e.humanRequests],backgroundColor:["rgba(52, 152, 219, 0.8)","rgba(52, 152, 219, 0.6)"]},{label:"Period B",data:[t.botRequests,t.humanRequests],backgroundColor:["rgba(231, 76, 60, 0.8)","rgba(231, 76, 60, 0.6)"]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}},plugins:{legend:{position:"top"}}}})}getDatesInRange(e,t){let s=[],a=new Date(e);for(;a<=t;)s.push(new Date(a)),a.setUTCDate(a.getUTCDate()+1);return s}destroyComparisonCharts(){Object.values(this.comparisonCharts).forEach(e=>e.destroy()),this.comparisonCharts={}}addFiles(e){for(let t of Array.from(e).filter(e=>"text/plain"===e.type||e.name.endsWith(".log")||e.name.endsWith(".txt")))this.selectedFiles.some(e=>e.name===t.name&&e.size===t.size)||this.selectedFiles.push(t);this.updateFileDisplay()}updateFileDisplay(){let e=document.getElementById("fileListContainer"),t=document.querySelector(".dropbox-content");e.innerHTML="",this.selectedFiles.length>0?(t.classList.add("hidden"),e.classList.remove("hidden"),this.selectedFiles.forEach((t,s)=>{let a=document.createElement("div");a.className="file-list-item",a.innerHTML='\n                <div class="file-icon">\uD83D\uDCC4</div>\n                <div class="file-details">\n                    <div class="file-name" title="'.concat(t.name,'">').concat(t.name,'</div>\n                    <div class="file-size">').concat(this.formatFileSize(t.size),'</div>\n                </div>\n                <button class="remove-file" data-index="').concat(s,'" title="Remove file">✕</button>\n            '),e.appendChild(a)})):(t.classList.remove("hidden"),e.classList.add("hidden")),document.getElementById("analyzeBtn").disabled=0===this.selectedFiles.length}removeFile(e){e>-1&&e<this.selectedFiles.length&&(this.selectedFiles.splice(e,1),this.updateFileDisplay())}clearFileSelection(){this.selectedFiles=[],document.getElementById("logFile").value="",this.updateFileDisplay()}clearAllData(){this.dailyStats={},this.currentAnalysis=null,this.fullFileAnalysis=null,this.comparisonData=null,this.countryFilter={mode:"all",countries:[]},this.destroyExistingCharts(),this.destroyComparisonCharts(),document.getElementById("results").classList.add("hidden"),document.getElementById("filteredInfo").classList.add("hidden"),document.getElementById("comparisonSection").classList.add("hidden"),this.clearFileSelection(),document.getElementById("progressBar").style.width="0%",document.getElementById("botUrlFilterCheckboxes").innerHTML="",document.querySelector("#botUrlHitsTable tbody").innerHTML="",document.querySelector("#botUrlHitsTable thead").innerHTML="",this.updateMultiSelectDisplayText("bot"),document.getElementById("referrerFilterCheckboxes").innerHTML="",document.querySelector("#trafficSourceTable tbody").innerHTML="",document.querySelector("#trafficSourceTable thead").innerHTML="",this.updateMultiSelectDisplayText("referrer");let e=document.getElementById("countryFilterCheckboxes");e&&(e.innerHTML=""),this.updateMultiSelectDisplayText("country"),this.updateCountryFilterSummary();let t=document.getElementById("compBotFilterCheckboxes"),s=document.getElementById("compReferrerFilterCheckboxes");t&&(t.innerHTML="",this.updateMultiSelectDisplayText("compBot")),s&&(s.innerHTML="",this.updateMultiSelectDisplayText("compReferrer"));let a=document.querySelector("#comparisonBotHitsTable tbody"),i=document.querySelector("#comparisonTrafficSourcesTable tbody");a&&(a.innerHTML=""),i&&(i.innerHTML=""),this.resetIpFilter(),this.clearIpFilterDropdown()}formatFileSize(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(Number.parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}async analyzeLogFile(){if(0===this.selectedFiles.length)return void alert("Please select one or more log files to analyze.");this.showLoading(!0),this.dailyStats={},this.countryFilter={mode:"all",countries:[]},this.updateCountryFilterSummary();try{await this.ipLookup.ensureLoaded();let e=this.selectedFiles.reduce((e,t)=>e+t.size,0),t=0,s=s=>{t+=s;let a=e>0?Math.min(t/e*80,80):0;this.updateProgress(a)},a=1;for(let e of this.selectedFiles){let t=document.getElementById("loadingStatus");t&&(t.textContent="Processing file ".concat(a," of ").concat(this.selectedFiles.length,": ").concat(e.name)),await this.processFileLineByLine(e,s),a++}let i=Object.keys(this.dailyStats).sort();if(0===i.length){alert("No valid log entries found in the selected file(s). Check file format and exclusion rules."),this.showLoading(!1);return}let r=new Date(i[0]),n=new Date(i[i.length-1]);this.fullFileAnalysis=this.aggregateStatsForRange(r,n),this.currentAnalysis=this.fullFileAnalysis;let l=document.getElementById("loadingStatus");l&&(l.textContent="Generating analysis..."),await new Promise(e=>setTimeout(e,50)),this.setupDateRangeControls(r,n),this.populateCountryFilterOptions(),this.displayResults(this.currentAnalysis),this.updateProgress(100)}catch(e){console.error("Error analyzing log files:",e),alert("Error analyzing log files: ".concat(e.message,"."))}finally{this.showLoading(!1)}}async processFileLineByLine(e,t){let s=0,a="",i=/^(\S+) \S+ \S+ \[([^\]]+)\] "(\S+) ([^"]*) HTTP\/[\d.]+" (\d+) (\d+|-) "([^"]*)" "([^"]*)"/;for(;s<e.size;){let r=e.slice(s,s+0x4000000),n=await r.text();t(r.size),s+=0x4000000;let l=(a+=n).split("\n");for(let e of(a=l.pop()||"",l))e&&this.processLogLine(e,i);await new Promise(e=>setTimeout(e,1))}a&&this.processLogLine(a,i)}addRejectionRuleRow(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.getElementById("rejectionRulesContainer"),s=document.createElement("div");s.className="rejection-rule-row";let a=document.createElement("input");a.type="text",a.placeholder="/path/to/exclude/",a.value=e;let i=document.createElement("button");i.className="remove-rule-btn",i.textContent="−",s.appendChild(a),s.appendChild(i),t.appendChild(s)}processLogLine(e,t){let s=t.exec(e);if(!s)return;let[,,,,a]=s;for(let e of this.rejectionPatterns)if(e&&a.startsWith(e))return;let[,i,r,n,l,o,c,d,u]=s,m=Number.parseInt(o);if(!Number.isNaN(m)&&!(m>=300))try{let[e,t,s,a]=r.replace(/(\d{2})\/(\w{3})\/(\d{4}):(\d{2}):(\d{2}):(\d{2}) ([+-]\d{4})/,"$1 $2 $3 $4:$5:$6").split(" "),[o,h,p]=a.split(":"),y=new Date(Date.UTC(Number.parseInt(s),{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[t],Number.parseInt(e),Number.parseInt(o),Number.parseInt(h),Number.parseInt(p)));if(isNaN(y))return;let g={ip:i,timestamp:y,method:n,url:l||"/",status:m,size:"-"===c?0:Number.parseInt(c),referer:d,userAgent:u,botInfo:this.detectBot(u),referrerDomain:this.extractReferrerDomain(d),country:this.getCountryForIp(i)};this.updateDailyStats(g)}catch(e){}}extractReferrerDomain(e){if(e&&e.startsWith("http"))try{return new URL(e).hostname}catch(e){}return"Direct"}getCountryForIp(e){if(!e||!this.ipLookup)return"Unknown";try{return this.ipLookup.findCountry(e)||"Unknown"}catch(e){return"Unknown"}}applyEntryToStatBlock(e,t){t.totalEntries++,t.totalBytes+=e.size,t.uniqueUrls.add(e.url),t.urlCounts[e.url]=(t.urlCounts[e.url]||0)+1,t.ipCounts[e.ip]=(t.ipCounts[e.ip]||0)+1;let s=Math.floor(e.status/100);t.statusCodes[s]=(t.statusCodes[s]||0)+1;let a=e.country||"Unknown";if(t.countryCounts[a]=(t.countryCounts[a]||0)+1,e.botInfo&&e.botInfo.isBot){t.botRequests++;let s=e.botInfo.name||"Unknown Bot",a=e.botInfo.type||"other";t.uniqueBots.add(s),t.botsByType[a]=(t.botsByType[a]||0)+1,t.botStats[s]||(t.botStats[s]={name:s,type:a,company:e.botInfo.company||"Unknown",count:0,lastSeen:e.timestamp}),t.botStats[s].count+=1,e.timestamp>t.botStats[s].lastSeen&&(t.botStats[s].lastSeen=e.timestamp),t.botUrlHits[e.url]||(t.botUrlHits[e.url]={}),t.botUrlHits[e.url][s]=(t.botUrlHits[e.url][s]||0)+1}else{t.humanRequests++;let s=e.referrerDomain||"Direct";t.humanReferrers[e.url]||(t.humanReferrers[e.url]={}),t.humanReferrers[e.url][s]=(t.humanReferrers[e.url][s]||0)+1}}mergeStatBlocks(e,t){for(let[s,a]of(e.totalEntries+=t.totalEntries,e.totalBytes+=t.totalBytes,e.botRequests+=t.botRequests,e.humanRequests+=t.humanRequests,t.uniqueUrls.forEach(t=>e.uniqueUrls.add(t)),t.uniqueBots.forEach(t=>e.uniqueBots.add(t)),Object.entries(t.statusCodes)))e.statusCodes[s]=(e.statusCodes[s]||0)+a;for(let[s,a]of Object.entries(t.urlCounts))e.urlCounts[s]=(e.urlCounts[s]||0)+a;for(let[s,a]of Object.entries(t.ipCounts))e.ipCounts[s]=(e.ipCounts[s]||0)+a;for(let[s,a]of Object.entries(t.botsByType))e.botsByType[s]=(e.botsByType[s]||0)+a;for(let[s,a]of Object.entries(t.botStats))e.botStats[s]?(e.botStats[s].count+=a.count,a.lastSeen>e.botStats[s].lastSeen&&(e.botStats[s].lastSeen=a.lastSeen)):e.botStats[s]={...a};for(let[s,a]of Object.entries(t.botUrlHits))for(let[t,i]of(e.botUrlHits[s]||(e.botUrlHits[s]={}),Object.entries(a)))e.botUrlHits[s][t]=(e.botUrlHits[s][t]||0)+i;for(let[s,a]of Object.entries(t.humanReferrers))for(let[t,i]of(e.humanReferrers[s]||(e.humanReferrers[s]={}),Object.entries(a)))e.humanReferrers[s][t]=(e.humanReferrers[s][t]||0)+i;for(let[s,a]of Object.entries(t.countryCounts||{}))e.countryCounts[s]=(e.countryCounts[s]||0)+a}entryMatchesCountryFilter(e,t){if(!t||"all"===t.mode||!Array.isArray(t.countries)||0===t.countries.length)return!0;let s=e.country||"Unknown",a=t.countries.includes(s);return"include"===t.mode?a:!a}updateDailyStats(e){let t=e.timestamp.toISOString().split("T")[0];this.dailyStats[t]||(this.dailyStats[t]=this.getNewStatBlock(!0));let s=this.dailyStats[t];this.applyEntryToStatBlock(e,s),Array.isArray(s.entries)&&s.entries.push(e)}aggregateStatsForRange(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this.getNewStatBlock();a.minDate=e,a.maxDate=t;let{countryFilter:i}=s,r=i&&"all"!==i.mode&&Array.isArray(i.countries)&&i.countries.length>0;for(let s of Object.keys(this.dailyStats).sort()){let n=new Date(s+"T00:00:00.000Z");if(n>=e&&n<=t){let e=this.dailyStats[s];if(!e)continue;if(r){if(!Array.isArray(e.entries))continue;for(let t of e.entries)this.entryMatchesCountryFilter(t,i)&&this.applyEntryToStatBlock(t,a)}else this.mergeStatBlocks(a,e)}}return a}getDailyDataForRange(e,t,s){let a={},i=s&&"all"!==s.mode&&Array.isArray(s.countries)&&s.countries.length>0;for(let r of Object.keys(this.dailyStats).sort()){let n=new Date(r+"T00:00:00.000Z");if(n<e||n>t)continue;let l=this.dailyStats[r];if(!l)continue;if(!i){a[r]=l;continue}let o=this.getNewStatBlock();if(o.minDate=n,o.maxDate=n,Array.isArray(l.entries))for(let e of l.entries)this.entryMatchesCountryFilter(e,s)&&this.applyEntryToStatBlock(e,o);a[r]=o}return a}getEntriesForRange(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],{countryFilter:i}=s,r=i&&"all"!==i.mode&&Array.isArray(i.countries)&&i.countries.length>0;for(let s of Object.keys(this.dailyStats).sort()){let n=new Date(s+"T00:00:00.000Z");if(n<e||n>t)continue;let l=this.dailyStats[s];if(l&&Array.isArray(l.entries)){if(!r){a.push(...l.entries);continue}for(let e of l.entries)this.entryMatchesCountryFilter(e,i)&&a.push(e)}}return a}getSelectedDateRange(){let e=document.getElementById("startDate"),t=document.getElementById("endDate");if(!e||!t||!e.value||!t.value){if(this.fullFileAnalysis)return{startDate:new Date(this.fullFileAnalysis.minDate),endDate:new Date(this.fullFileAnalysis.maxDate)};let e=new Date;return{startDate:e,endDate:e}}return{startDate:new Date(e.value+"T00:00:00.000Z"),endDate:new Date(t.value+"T00:00:00.000Z")}}getCountryCountsForRange(e,t){let s={};for(let a of Object.keys(this.dailyStats).sort()){let i=new Date(a+"T00:00:00.000Z");if(i>=e&&i<=t){let e=this.dailyStats[a];if(!e||!e.countryCounts)continue;for(let[t,a]of Object.entries(e.countryCounts))s[t]=(s[t]||0)+a}}return s}populateCountryFilterOptions(){let e=document.getElementById("countryFilterCheckboxes");if(!e)return;if(e.innerHTML="",!this.fullFileAnalysis)return void this.updateMultiSelectDisplayText("country");let t=Object.entries(this.getCountryCountsForRange(this.fullFileAnalysis.minDate,this.fullFileAnalysis.maxDate)).sort((e,t)=>t[1]-e[1]);if(0===t.length)return void this.updateMultiSelectDisplayText("country");t.forEach(t=>{let[s,a]=t,i=document.createElement("label"),r=document.createElement("input");r.type="checkbox",r.value=s;let n="Unknown"===s?"Unknown":s,l=document.createTextNode(" ".concat(n," (").concat(a.toLocaleString(),")"));i.appendChild(r),i.appendChild(l),e.appendChild(i)}),this.updateMultiSelectDisplayText("country")}applyCountryFilter(){if(!this.fullFileAnalysis)return void alert("Analyze log files before applying country filters.");let e=document.getElementById("countryFilterCheckboxes"),t=document.getElementById("countryFilterMode");if(!e||!t)return;let s=Array.from(e.querySelectorAll("input:checked")).map(e=>e.value),a=t.value||"include";0===s.length?this.countryFilter={mode:"all",countries:[]}:this.countryFilter={mode:a,countries:s};let{startDate:i,endDate:r}=this.getSelectedDateRange();this.currentAnalysis=this.aggregateStatsForRange(i,r,{countryFilter:this.countryFilter}),this.displayResults(this.currentAnalysis),this.fullFileAnalysis&&i.getTime()===new Date(this.fullFileAnalysis.minDate).getTime()&&r.getTime()===new Date(this.fullFileAnalysis.maxDate).getTime()?document.getElementById("filteredInfo").classList.add("hidden"):this.showFilteredInfo(this.currentAnalysis);let n=document.getElementById("countryFilterOptions");n&&n.classList.remove("visible"),this.updateCountryFilterSummary()}resetCountryFilter(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.countryFilter={mode:"all",countries:[]};let t=document.getElementById("countryFilterMode");t&&(t.value="include");let s=document.getElementById("countryFilterCheckboxes");s&&s.querySelectorAll("input").forEach(e=>{e.checked=!1}),this.updateMultiSelectDisplayText("country"),this.updateCountryFilterSummary();let a=document.getElementById("countryFilterOptions");if(a&&a.classList.remove("visible"),e||!this.fullFileAnalysis)return;let{startDate:i,endDate:r}=this.getSelectedDateRange();this.currentAnalysis=this.aggregateStatsForRange(i,r,{countryFilter:this.countryFilter}),this.displayResults(this.currentAnalysis),i.getTime()===new Date(this.fullFileAnalysis.minDate).getTime()&&r.getTime()===new Date(this.fullFileAnalysis.maxDate).getTime()?document.getElementById("filteredInfo").classList.add("hidden"):this.showFilteredInfo(this.currentAnalysis)}updateCountryFilterSummary(){let e=document.getElementById("countryFilterSummary");if(!e)return;if(!this.fullFileAnalysis){e.textContent="Analyze logs to enable country filtering.";return}let{mode:t,countries:s}=this.countryFilter;if("all"===t||!s||0===s.length){e.textContent="Showing traffic from all countries.";return}let a=s.slice(0,5).join(", "),i=s.length>5?"…":"";"include"===t?e.textContent="Including ".concat(s.length," ").concat(1===s.length?"country":"countries",": ").concat(a).concat(i):e.textContent="Excluding ".concat(s.length," ").concat(1===s.length?"country":"countries",": ").concat(a).concat(i)}updateProgress(e){let t=document.getElementById("progressBar");t&&(t.style.width="".concat(e,"%"))}detectBot(e){for(let[t,s]of Object.entries(this.botPatterns))for(let a of s)if(a.pattern.test(e))return{isBot:!0,name:a.name,type:t,company:a.company};for(let t of[/bot/i,/crawler/i,/spider/i,/scraper/i,/fetcher/i,/monitor/i,/checker/i,/validator/i,/indexer/i])if(t.test(e)){let t=e.match(/(\w+bot|\w+spider|\w+crawler)/i);return{isBot:!0,name:t?t[1]:"Unknown Bot",type:"other",company:"Unknown"}}return{isBot:!1,name:null,type:null,company:null}}displayResults(e){this.destroyExistingCharts(),this.displayStatistics(e),this.displayBotAnalysis(e),this.createAllCharts(e),this.populateBotFilterControls(e.botStats),this.populateReferrerFilterControls(e.humanReferrers),this.createAllTables(e),this.populateIpFilterDropdown(e.ipCounts),document.getElementById("results").classList.remove("hidden"),this.updateCountryFilterSummary(),this.applyIpFilter({silent:!0})}displayStatistics(e){let t=e.minDate&&e.maxDate?Math.max(1,Math.ceil((e.maxDate-e.minDate)/864e5)):1;document.getElementById("uniqueUrls").textContent=e.uniqueUrls.size.toLocaleString(),document.getElementById("uniqueUrlsPerDay").textContent=Math.round(e.uniqueUrls.size/t).toLocaleString(),document.getElementById("totalEvents").textContent=e.totalEntries.toLocaleString(),document.getElementById("eventsPerDay").textContent=Math.round(e.totalEntries/t).toLocaleString(),document.getElementById("totalBytes").textContent=this.formatBytes(e.totalBytes),document.getElementById("avgBytes").textContent=this.formatBytes(e.totalEntries>0?Math.round(e.totalBytes/e.totalEntries):0),document.getElementById("bytesPerDay").textContent=this.formatBytes(Math.round(e.totalBytes/t)),document.getElementById("successCount").textContent=(e.statusCodes[2]||0).toLocaleString(),document.getElementById("redirectionCount").textContent=(e.statusCodes[3]||0).toLocaleString(),document.getElementById("clientErrorCount").textContent=(e.statusCodes[4]||0).toLocaleString(),document.getElementById("serverErrorCount").textContent=(e.statusCodes[5]||0).toLocaleString(),document.getElementById("errorCount").textContent=((e.statusCodes[4]||0)+(e.statusCodes[5]||0)).toLocaleString(),document.getElementById("totalBotRequests").textContent=e.botRequests.toLocaleString(),document.getElementById("botTrafficPercentage").textContent=e.totalEntries>0?"".concat((e.botRequests/e.totalEntries*100).toFixed(1),"%"):"0%",document.getElementById("uniqueBots").textContent=e.uniqueBots.size.toLocaleString(),document.getElementById("humanTrafficPercentage").textContent=e.totalEntries>0?"".concat((e.humanRequests/e.totalEntries*100).toFixed(1),"%"):"0%"}displayBotAnalysis(e){["seo","ai","social","monitoring","security","other"].forEach(t=>{document.getElementById("".concat(t,"BotsCount")).textContent="".concat((e.botsByType[t]||0).toLocaleString()," requests"),this.populateBotList(t,e.botStats,e.totalEntries)})}populateBotList(e,t,s){let a=document.getElementById("".concat(e,"BotsList"));a.innerHTML="";let i=Object.values(t).filter(t=>t.type===e).sort((e,t)=>t.count-e.count);if(0===i.length){a.innerHTML='<div class="empty-category">No bots detected in this category</div>';return}i.forEach(e=>{let t=s>0?(e.count/s*100).toFixed(2):0,i=document.createElement("div");i.className="bot-item",i.innerHTML='\n        <div class="bot-info">\n          <div class="bot-name">'.concat(e.name,'</div>\n          <div class="bot-company">').concat(e.company,'</div>\n        </div>\n        <div class="bot-stats">\n          <div class="bot-requests">').concat(e.count.toLocaleString(),' requests</div>\n          <div class="bot-percentage">').concat(t,"%</div>\n        </div>"),a.appendChild(i)})}destroyExistingCharts(){Object.values(this.charts).forEach(e=>e.destroy()),this.charts={}}createAllCharts(e){let t=this.getDailyDataForRange(e.minDate,e.maxDate,this.countryFilter);this.createResponseCodesChart(t),this.createEventsChart(t),this.createBotActivityChart(t),this.createBotDistributionChart(e.botStats)}createResponseCodesChart(e){let t=document.getElementById("responseCodesChart").getContext("2d"),s=Object.keys(e).sort(),a=[{label:"Success (2xx)",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.statusCodes[2])||0}),borderColor:"#27ae60",tension:.1},{label:"Redirection (3xx)",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.statusCodes[3])||0}),borderColor:"#f39c12",tension:.1},{label:"Client Error (4xx)",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.statusCodes[4])||0}),borderColor:"#e74c3c",tension:.1},{label:"Server Error (5xx)",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.statusCodes[5])||0}),borderColor:"#8e44ad",tension:.1}];this.charts.responseCodes=new r.Ay(t,{type:"line",data:{labels:s,datasets:a},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}createEventsChart(e){let t=document.getElementById("eventsChart").getContext("2d"),s=Object.keys(e).sort();this.charts.events=new r.Ay(t,{type:"line",data:{labels:s,datasets:[{label:"Total Events",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.totalEntries)||0}),borderColor:"#3498db",tension:.1,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}createBotActivityChart(e){let t=document.getElementById("botActivityChart").getContext("2d"),s=Object.keys(e).sort(),a=[{label:"Human Traffic",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.humanRequests)||0}),borderColor:"#27ae60",tension:.1},{label:"Bot Traffic",data:s.map(t=>{var s;return(null==(s=e[t])?void 0:s.botRequests)||0}),borderColor:"#e74c3c",tension:.1}];this.charts.botActivity=new r.Ay(t,{type:"line",data:{labels:s,datasets:a},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}createBotDistributionChart(e){let t=document.getElementById("botDistributionChart").getContext("2d"),s=Object.values(e).sort((e,t)=>t.count-e.count).slice(0,10);this.charts.botDistribution=new r.Ay(t,{type:"doughnut",data:{labels:s.map(e=>e.name),datasets:[{data:s.map(e=>e.count),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#c8a2c8","#fd7f6f","#7eb0d5","#b2e061"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"}}}})}createAllTables(e){this.createTopUrlsTable(e.urlCounts,e.totalEntries),this.createBotTable(e.botStats,e.totalEntries),this.createBotUrlHitsTable(e.botUrlHits),this.createTrafficSourceTable(e.humanReferrers)}createTopUrlsTable(e,t){let s=Object.entries(e).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,20),a=document.querySelector("#topUrlsTable tbody");a.innerHTML="",s.forEach(e=>{let[s,i]=e,r=t>0?(i/t*100).toFixed(2):0;a.insertRow().innerHTML='<td title="'.concat(s,'">').concat(s.length>50?"".concat(s.substring(0,50),"..."):s,"</td><td>").concat(i.toLocaleString(),'</td><td class="percentage">').concat(r,"%</td>")})}createBotTable(e,t){let s=Object.values(e).sort((e,t)=>t.count-e.count).slice(0,50),a=document.querySelector("#botDetailsTable tbody");a.innerHTML="",s.forEach(e=>{let s=t>0?(e.count/t*100).toFixed(2):0;a.insertRow().innerHTML="<td><strong>".concat(e.name,"</strong><br><small>").concat(e.company,'</small></td><td><span class="bot-type-').concat(e.type,'">').concat(e.type.toUpperCase(),"</span></td><td>").concat(e.count.toLocaleString(),'</td><td class="percentage">').concat(s,"%</td><td>").concat(new Date(e.lastSeen).toLocaleString(),"</td>")})}updateMultiSelectDisplayText(e){let t=document.getElementById("".concat(e,"FilterDisplay")),s=document.getElementById("".concat(e,"FilterCheckboxes"));if(!s||!t)return;let a=s.querySelectorAll("input:checked").length,i=s.querySelectorAll("input").length,r="items";"bot"===e?r="bots":"referrer"===e?r="referrers":"compBot"===e?r="bots":"compReferrer"===e?r="referrers":"country"===e&&(r="countries"),0===i?t.textContent="No ".concat(r," detected"):0===a?"country"===e?t.textContent="All countries":t.textContent="Select ".concat(r.charAt(0).toUpperCase()+r.slice(1)):a===i?"country"===e?t.textContent="All countries selected":t.textContent="All ".concat(r," selected"):t.textContent="".concat(a," of ").concat(i," ").concat(r," selected")}populateBotFilterControls(e){let t=document.getElementById("botUrlFilterCheckboxes");t.innerHTML="";let s=Object.values(e).sort((e,t)=>t.count-e.count);if(0===s.length)return void this.updateMultiSelectDisplayText("bot");let a=s.slice(0,10).map(e=>e.name);s.forEach(e=>{let s=document.createElement("label"),i=document.createElement("input");i.type="checkbox",i.value=e.name,i.checked=a.includes(e.name);let r=document.createTextNode(" ".concat(e.name));s.appendChild(i),s.appendChild(r),t.appendChild(s)}),this.updateMultiSelectDisplayText("bot")}populateReferrerFilterControls(e){let t=document.getElementById("referrerFilterCheckboxes");t.innerHTML="";let s=new Set,a={};for(let t in e)for(let[i,r]of Object.entries(e[t]))s.add(i),a[i]=(a[i]||0)+r;let i=Array.from(s).sort((e,t)=>"Direct"===e?-1:"Direct"===t?1:e.localeCompare(t));if(0===i.length)return void this.updateMultiSelectDisplayText("referrer");let r=Object.entries(a).filter(e=>{let[t]=e;return"Direct"!==t}).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,5).map(e=>{let[t]=e;return t});i.forEach(e=>{let s=document.createElement("label"),a=document.createElement("input");a.type="checkbox",a.value=e,a.checked="Direct"===e||r.includes(e);let i=document.createTextNode(" ".concat(e));s.appendChild(a),s.appendChild(i),t.appendChild(s)}),this.updateMultiSelectDisplayText("referrer")}populateIpFilterDropdown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=document.getElementById("ipFilterList"),s=document.getElementById("ipFilterDisplay"),a=document.getElementById("ipFilterOptions"),i=document.getElementById("ipFilterSearch");if(!t||!s)return;let r=this.selectedIpFilter||"";t.innerHTML="",this.allIpEntries=[];let n=Object.entries(e);if(0===n.length){s.textContent="No IPs detected",i&&(i.value="",i.disabled=!0),a&&a.classList.remove("visible");let e=document.createElement("div");e.className="multiselect-empty",e.textContent="Analyze logs to populate the IP list.",t.appendChild(e);return}let l=n.sort((e,t)=>{let[,s]=e,[,a]=t;return a-s});this.allIpEntries=l;let o=l.slice(0,500);this.renderIpFilterOptions(t,o,r),i&&(i.disabled=!1,i.value=""),this.updateIpFilterDropdownSelection(r)}clearIpFilterDropdown(){let e=document.getElementById("ipFilterList"),t=document.getElementById("ipFilterDisplay"),s=document.getElementById("ipFilterOptions"),a=document.getElementById("ipFilterSearch");e&&(e.innerHTML=""),t&&(t.textContent="Select IP"),s&&s.classList.remove("visible"),a&&(a.value="",a.disabled=!0),this.allIpEntries=[],this.selectedIpFilter=""}renderIpFilterOptions(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(e){if(e.innerHTML="",!t.length){if(a){let t=document.createElement("div");t.className="multiselect-empty",t.textContent=a,e.appendChild(t)}return}t.forEach(t=>{let[a,i]=t,r=document.createElement("label"),n=document.createElement("input");n.type="radio",n.name="ipFilterRadio",n.value=a,n.checked=s===a;let l=document.createTextNode(" ".concat(a," (").concat(i.toLocaleString()," hits)"));r.appendChild(n),r.appendChild(l),e.appendChild(r)})}}updateIpFilterDropdownSelection(e){let t=document.getElementById("ipFilterList"),s=document.getElementById("ipFilterDisplay");if(!t||!s)return;this.selectedIpFilter=e||"";let a=t.querySelectorAll('input[type="radio"]'),i=!1;a.forEach(t=>{t.value===e?(t.checked=!0,i=!0):t.checked=!1}),i&&e||e?s.textContent=e:0===a.length?s.textContent="No IPs detected":s.textContent="Select IP"}getSelectedIpFilterValue(){if(this.selectedIpFilter)return this.selectedIpFilter;let e=document.querySelector('#ipFilterList input[type="radio"]:checked');return e?e.value.trim():""}createBotUrlHitsTable(e){let t=document.querySelector("#botUrlHitsTable thead"),s=document.querySelector("#botUrlHitsTable tbody");t.innerHTML="",s.innerHTML="";let a=Array.from(document.querySelectorAll("#botUrlFilterCheckboxes input:checked")).map(e=>e.value);if(0===a.length){s.innerHTML='<tr class="table-placeholder"><td colspan="1">Select one or more bots to display data.</td></tr>';return}let i=t.insertRow();i.innerHTML="<th>URL</th>",a.forEach(e=>{i.innerHTML+="<th>".concat(e,"</th>")}),i.innerHTML+="<th>Total</th>";let r=[];for(let[t,s]of Object.entries(e)){let e=0,i=!1,n={};for(let t of a){let a=s[t]||0;a>0&&(i=!0,e+=a,n[t]=a)}i&&r.push({url:t,totalHits:e,botCounts:n})}r.sort((e,t)=>t.totalHits-e.totalHits);let n=r.slice(0,100);if(0===n.length){s.innerHTML='<tr class="table-placeholder"><td colspan="'.concat(a.length+2,'">No hits found for the selected bots in this period.</td></tr>');return}n.forEach(e=>{let t=s.insertRow(),i='<td title="'.concat(e.url,'">').concat(e.url.length>70?"".concat(e.url.substring(0,70),"..."):e.url,"</td>");a.forEach(t=>{i+="<td>".concat((e.botCounts[t]||0).toLocaleString(),"</td>")}),t.innerHTML=i+="<td><strong>".concat(e.totalHits.toLocaleString(),"</strong></td>")});let l=s.insertRow(),o="<td><strong>Total</strong></td>";a.forEach(e=>{let t=n.reduce((t,s)=>t+(s.botCounts[e]||0),0);o+="<td><strong>".concat(t.toLocaleString(),"</strong></td>")});let c=n.reduce((e,t)=>e+t.totalHits,0);l.innerHTML=o+="<td><strong>".concat(c.toLocaleString(),"</strong></td>")}createTrafficSourceTable(e){let t=document.querySelector("#trafficSourceTable thead"),s=document.querySelector("#trafficSourceTable tbody");t.innerHTML="",s.innerHTML="";let a=Array.from(document.querySelectorAll("#referrerFilterCheckboxes input:checked")).map(e=>e.value);if(0===a.length){s.innerHTML='<tr class="table-placeholder"><td colspan="1">Select one or more referrers to display data.</td></tr>';return}let i=t.insertRow();i.innerHTML="<th>Destination URL</th>",a.forEach(e=>{i.innerHTML+="<th>".concat(e,"</th>")}),i.innerHTML+="<th>Total</th>";let r=[];for(let[t,s]of Object.entries(e)){let e=0,i=!1,n={};for(let t of a){let a=s[t]||0;a>0&&(i=!0,e+=a,n[t]=a)}i&&r.push({url:t,totalHits:e,referrerCounts:n})}r.sort((e,t)=>t.totalHits-e.totalHits);let n=r.slice(0,100);if(0===n.length){s.innerHTML='<tr class="table-placeholder"><td colspan="'.concat(a.length+2,'">No traffic found from the selected referrers in this period.</td></tr>');return}n.forEach(e=>{let t=s.insertRow(),i='<td title="'.concat(e.url,'">').concat(e.url.length>50?"".concat(e.url.substring(0,50),"..."):e.url,"</td>");a.forEach(t=>{i+="<td>".concat((e.referrerCounts[t]||0).toLocaleString(),"</td>")}),t.innerHTML=i+="<td><strong>".concat(e.totalHits.toLocaleString(),"</strong></td>")});let l=s.insertRow(),o="<td><strong>Total</strong></td>";a.forEach(e=>{let t=n.reduce((t,s)=>t+(s.referrerCounts[e]||0),0);o+="<td><strong>".concat(t.toLocaleString(),"</strong></td>")});let c=n.reduce((e,t)=>e+t.totalHits,0);l.innerHTML=o+="<td><strong>".concat(c.toLocaleString(),"</strong></td>")}applyIpFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{silent:t=!1}=e,s=this.getSelectedIpFilterValue();if(this.updateIpFilterDropdownSelection(s),!s)return void this.hideIpFilterResults();if(!this.fullFileAnalysis){t||alert("Analyze log files before filtering by IP."),this.hideIpFilterResults();return}let{startDate:a,endDate:i}=this.getSelectedDateRange(),r=this.getEntriesForRange(a,i,{countryFilter:this.countryFilter}).filter(e=>e.ip===s);r.sort((e,t)=>e.timestamp-t.timestamp),this.updateIpFilterResults(r,s,a,i)}resetIpFilter(){this.selectedIpFilter="",document.querySelectorAll('#ipFilterList input[type="radio"]').forEach(e=>{e.checked=!1}),this.hideIpFilterResults(),this.updateIpFilterDropdownSelection("")}hideIpFilterResults(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=document.getElementById("ipFilterResultsWrapper"),s=document.querySelector("#ipFilterResults tbody"),a=document.getElementById("ipFilterSummaryText"),i=document.getElementById("ipFilterCountry");t&&t.classList.add("hidden"),s&&(s.innerHTML=""),e&&a&&(a.textContent=""),e&&i&&(i.textContent=""),this.ipFilterEntries=[]}updateIpFilterResults(e,t,s,a){let i=document.getElementById("ipFilterResultsWrapper"),r=document.querySelector("#ipFilterResults tbody"),n=document.getElementById("ipFilterSummaryText"),l=document.getElementById("ipFilterCountry");if(!i||!r||!n||!l)return;i.classList.remove("hidden");let o="".concat(s.toLocaleDateString()," - ").concat(a.toLocaleDateString()),c=e.length>0?e[0].country||"Unknown":this.getCountryForIp(t)||"Unknown";if(this.ipFilterEntries=e.slice(),0===e.length){n.textContent="No entries for ".concat(t," between ").concat(o,"."),l.textContent="Country: ".concat(c),r.innerHTML='<tr class="table-placeholder"><td colspan="6">No matching requests for this IP.</td></tr>',this.ipFilterEntries=[];return}n.textContent="Showing ".concat(e.length.toLocaleString()," ").concat(1===e.length?"entry":"entries"," for ").concat(t," between ").concat(o,"."),l.textContent="Country: ".concat(c),r.innerHTML=e.map(e=>{let t=this.formatTimestamp(e.timestamp),s=e.url||"/",a=s.length>80?"".concat(s.substring(0,77),"..."):s,i=e.referrerDomain||"Direct",r=e.referer&&"-"!==e.referer?e.referer:i;return'<tr><td title="'.concat(t,'">').concat(t,"</td><td>").concat(e.ip,"</td><td>").concat(e.method,'</td><td title="').concat(s,'">').concat(a,"</td><td>").concat(e.status,'</td><td title="').concat(r,'">').concat(i,"</td></tr>")}).join("")}exportIpFilterResults(){if(!this.ipFilterEntries||0===this.ipFilterEntries.length)return void alert("Filter an IP first to export its entries.");let e=new Blob([["Timestamp	IP	Method	URL	Status	Referer",...this.ipFilterEntries.map(e=>{let t=this.formatTimestamp(e.timestamp),s=e.url||"/",a=e.referer&&"-"!==e.referer?e.referer:e.referrerDomain||"Direct";return"".concat(t,"	").concat(e.ip,"	").concat(e.method,"	").concat(s,"	").concat(e.status,"	").concat(a)})].join("\n")],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),s=document.createElement("a"),a=this.selectedIpFilter||"ip-filter",i=new Date().toISOString().replace(/[:.]/g,"-");s.href=t,s.download="".concat(a,"-requests-").concat(i,".txt"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)}formatBytes(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(Number.parseFloat((e/Math.pow(1024,t)).toFixed(2))," ").concat(["B","KB","MB","GB","TB"][t])}formatTimestamp(e){return!(e instanceof Date)||Number.isNaN(e.getTime())?"":e.toLocaleString()}showLoading(e){document.getElementById("loadingIndicator").classList.toggle("hidden",!e),document.getElementById("results").classList.toggle("hidden",e),e&&this.destroyExistingCharts()}setupDateRangeControls(e,t){let s=document.getElementById("startDate"),a=document.getElementById("endDate"),i=e.toISOString().split("T")[0],r=t.toISOString().split("T")[0];s.min=i,s.max=r,a.min=i,a.max=r,s.value=i,a.value=r,document.getElementById("totalLogEntries").textContent="".concat(this.fullFileAnalysis.totalEntries.toLocaleString()," total entries"),document.getElementById("dateRangeSpan").textContent="".concat(e.toLocaleDateString()," - ").concat(t.toLocaleDateString())}applyDateFilter(){if(!this.fullFileAnalysis)return;let e=new Date(document.getElementById("startDate").value+"T00:00:00.000Z"),t=new Date(document.getElementById("endDate").value+"T00:00:00.000Z");if(t<e)return void alert("End date cannot be earlier than start date.");this.currentAnalysis=this.aggregateStatsForRange(e,t,{countryFilter:this.countryFilter}),this.displayResults(this.currentAnalysis),this.showFilteredInfo(this.currentAnalysis)}applyQuickFilter(e){if(!this.fullFileAnalysis)return;let t=new Date(this.fullFileAnalysis.maxDate),s=new Date(t);s.setUTCDate(s.getUTCDate()-(e-1)),document.getElementById("startDate").value=s.toISOString().split("T")[0],document.getElementById("endDate").value=t.toISOString().split("T")[0],this.currentAnalysis=this.aggregateStatsForRange(s,t,{countryFilter:this.countryFilter}),this.displayResults(this.currentAnalysis),this.showFilteredInfo(this.currentAnalysis)}resetDateFilter(){this.fullFileAnalysis&&(this.setupDateRangeControls(this.fullFileAnalysis.minDate,this.fullFileAnalysis.maxDate),this.currentAnalysis=this.aggregateStatsForRange(this.fullFileAnalysis.minDate,this.fullFileAnalysis.maxDate,{countryFilter:this.countryFilter}),this.displayResults(this.currentAnalysis),document.getElementById("filteredInfo").classList.add("hidden"))}showFilteredInfo(e){let t=document.getElementById("filteredInfo");document.getElementById("filteredEntries").textContent="".concat(e.totalEntries.toLocaleString()," entries"),document.getElementById("filteredDateRange").textContent="".concat(e.minDate.toLocaleDateString()," - ").concat(e.maxDate.toLocaleDateString()),t.classList.remove("hidden")}setupFilterSearch(e,t){e.addEventListener("keyup",e=>{let s=e.target.value.toLowerCase();t.querySelectorAll("label").forEach(e=>{e.textContent.toLowerCase().includes(s)?e.style.display="flex":e.style.display="none"})})}setupIpFilterSearch(e,t){e.addEventListener("input",e=>{if(!t||0===this.allIpEntries.length)return;let s=e.target.value.toLowerCase().trim(),a=this.selectedIpFilter||"";if(!s){let e=this.allIpEntries.slice(0,500);this.renderIpFilterOptions(t,e,a);return}let i=this.allIpEntries.filter(e=>{let[t]=e;return t.toLowerCase().includes(s)}).slice(0,500);this.renderIpFilterOptions(t,i,a,"No matching IPs")})}destroy(){}constructor(){this.dailyStats={},this.currentAnalysis=null,this.fullFileAnalysis=null,this.charts={},this.comparisonCharts={},this.comparisonData=null,this.rejectionPatterns=[],this.selectedFiles=[],this.botPatterns=this.initializeBotPatterns(),this.ipLookup=new n,this.countryFilter={mode:"all",countries:[]},this.selectedIpFilter="",this.allIpEntries=[],this.ipFilterEntries=[],this.initializeEventListeners()}}let o=()=>((0,i.useEffect)(()=>{let e=new l;return()=>{"function"==typeof e.destroy&&e.destroy()}},[]),(0,a.jsx)("main",{className:"analyzer-page",children:(0,a.jsx)("div",{className:"analyzer-app",children:(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("header",{className:"header",children:(0,a.jsxs)("div",{className:"header-content",children:[(0,a.jsx)("div",{className:"logo-section",children:(0,a.jsx)("h1",{children:"Access Log Analyzer"})}),(0,a.jsx)("div",{className:"header-actions",children:(0,a.jsx)("button",{id:"clearData",className:"header-btn secondary",children:"Clear Data"})})]})}),(0,a.jsx)("div",{className:"upload-section",children:(0,a.jsxs)("div",{className:"upload-container",children:[(0,a.jsxs)("div",{className:"dropbox",id:"dropbox",children:[(0,a.jsxs)("div",{className:"dropbox-content",children:[(0,a.jsx)("div",{className:"upload-icon",children:"\uD83D\uDCC1"}),(0,a.jsx)("p",{className:"dropbox-text",children:"Drag & drop your log file(s) here"}),(0,a.jsx)("p",{className:"dropbox-subtext",children:"or click to browse (.log, .txt files)"}),(0,a.jsx)("input",{type:"file",id:"logFile",accept:".log,.txt",className:"file-input",multiple:!0})]}),(0,a.jsx)("div",{id:"fileListContainer",className:"hidden"})]}),(0,a.jsxs)("div",{id:"fileSizeWarning",className:"file-size-warning hidden",children:[(0,a.jsx)("strong",{children:"Large File(s) Detected:"})," Processing may take several minutes."]}),(0,a.jsx)("button",{id:"analyzeBtn",className:"analyze-btn",disabled:!0,children:"Analyze Log File(s)"})]})}),(0,a.jsxs)("div",{id:"loadingIndicator",className:"loading hidden",children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("p",{children:"Analyzing log file(s)..."}),(0,a.jsx)("div",{className:"loading-details",children:(0,a.jsx)("span",{id:"loadingStatus",children:"Processing..."})}),(0,a.jsx)("div",{className:"progress-container",children:(0,a.jsx)("div",{className:"progress-bar",id:"progressBar"})}),(0,a.jsxs)("div",{className:"performance-tip",children:[(0,a.jsx)("strong",{children:"Tip:"})," Large files may take several minutes. This runs in your browser."]})]}),(0,a.jsxs)("div",{id:"results",className:"results hidden",children:[(0,a.jsxs)("div",{id:"dateRangeSection",className:"date-range-section",children:[(0,a.jsxs)("div",{className:"date-range-header",children:[(0,a.jsx)("h3",{children:"\uD83D\uDCC5 Date Range Filter"}),(0,a.jsxs)("div",{className:"date-range-info",children:[(0,a.jsx)("span",{id:"totalLogEntries",children:"0 total entries"}),(0,a.jsx)("span",{id:"dateRangeSpan",children:"No data"})]})]}),(0,a.jsxs)("div",{className:"date-range-controls",children:[(0,a.jsxs)("div",{className:"date-input-group",children:[(0,a.jsx)("label",{htmlFor:"startDate",children:"From:"}),(0,a.jsx)("input",{type:"date",id:"startDate",className:"date-input"})]}),(0,a.jsxs)("div",{className:"date-input-group",children:[(0,a.jsx)("label",{htmlFor:"endDate",children:"To:"}),(0,a.jsx)("input",{type:"date",id:"endDate",className:"date-input"})]}),(0,a.jsxs)("div",{className:"date-range-buttons",children:[(0,a.jsx)("button",{id:"applyDateRange",className:"apply-btn",children:"Apply Filter"}),(0,a.jsx)("button",{id:"resetDateRange",className:"reset-btn",children:"Reset"}),(0,a.jsx)("button",{id:"showComparison",className:"comparison-btn",children:"\uD83D\uDCCA Compare Periods"})]}),(0,a.jsxs)("div",{className:"quick-filters",children:[(0,a.jsx)("button",{className:"quick-filter-btn","data-days":"1",children:"Today"}),(0,a.jsx)("button",{className:"quick-filter-btn","data-days":"7",children:"Last 7 Days"}),(0,a.jsx)("button",{className:"quick-filter-btn","data-days":"30",children:"Last 30 Days"}),(0,a.jsx)("button",{className:"quick-filter-btn","data-days":"90",children:"Last 90 Days"})]}),(0,a.jsxs)("div",{className:"country-filter-section",children:[(0,a.jsxs)("div",{className:"country-filter-header",children:[(0,a.jsx)("h3",{children:"\uD83C\uDF0D Country Filter"}),(0,a.jsx)("p",{id:"countryFilterSummary",className:"country-filter-summary",children:"Analyze logs to enable country filtering."})]}),(0,a.jsxs)("div",{className:"country-filter-controls",children:[(0,a.jsxs)("div",{className:"multiselect-dropdown",id:"countryFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"countryFilterDisplay",children:"All countries"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"countryFilterOptions",children:[(0,a.jsxs)("div",{className:"multiselect-actions",children:[(0,a.jsx)("button",{className:"filter-action-btn","data-action":"select-all",children:"Select All"}),(0,a.jsx)("button",{className:"filter-action-btn","data-action":"deselect-all",children:"Deselect All"})]}),(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"countryFilterSearch",className:"multiselect-search-input",placeholder:"Search countries..."})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"countryFilterCheckboxes"})]})]}),(0,a.jsxs)("select",{id:"countryFilterMode",className:"country-mode-select",children:[(0,a.jsx)("option",{value:"include",children:"Include selected"}),(0,a.jsx)("option",{value:"exclude",children:"Exclude selected"})]}),(0,a.jsxs)("div",{className:"country-filter-buttons",children:[(0,a.jsx)("button",{id:"applyCountryFilter",className:"apply-btn",children:"Apply Country Filter"}),(0,a.jsx)("button",{id:"resetCountryFilter",className:"reset-btn",children:"Reset"})]})]})]})]}),(0,a.jsxs)("div",{className:"filtered-info hidden",id:"filteredInfo",children:[(0,a.jsx)("span",{id:"filteredEntries",children:"0 entries"})," shown from",(0,a.jsx)("span",{id:"filteredDateRange",children:"date range"})]}),(0,a.jsxs)("div",{className:"ip-filter-section",children:[(0,a.jsx)("div",{className:"ip-filter-header",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"\uD83D\uDD0D IP Activity Filter"}),(0,a.jsx)("p",{children:"Enter an IP address to list every matching request inside the selected date range."})]})}),(0,a.jsxs)("div",{className:"ip-filter-controls",children:[(0,a.jsxs)("div",{className:"multiselect-dropdown ip-filter-dropdown",id:"ipFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"ipFilterDisplay",children:"Select IP"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"ipFilterOptions",children:[(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"ipFilterSearch",className:"multiselect-search-input",placeholder:"Search IPs...",disabled:!0})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"ipFilterList"})]})]}),(0,a.jsx)("button",{id:"applyIpFilter",className:"apply-btn",children:"Filter IP"}),(0,a.jsx)("button",{id:"resetIpFilter",className:"reset-btn",children:"Clear"})]}),(0,a.jsx)("p",{className:"ip-filter-hint",children:"Hint: Use the IP picker to search and select an address before filtering."}),(0,a.jsxs)("div",{className:"ip-filter-results hidden",id:"ipFilterResultsWrapper",children:[(0,a.jsxs)("div",{className:"ip-filter-summary",children:[(0,a.jsx)("span",{id:"ipFilterSummaryText"}),(0,a.jsx)("span",{id:"ipFilterCountry",className:"ip-filter-country"})]}),(0,a.jsx)("div",{className:"ip-filter-actions",children:(0,a.jsx)("button",{id:"exportIpFilterResults",className:"export-btn",children:"Export Results"})}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"ipFilterResults",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Timestamp"}),(0,a.jsx)("th",{children:"IP"}),(0,a.jsx)("th",{children:"Method"}),(0,a.jsx)("th",{children:"URL"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Referer"})]})}),(0,a.jsx)("tbody",{})]})})]})]})]}),(0,a.jsxs)("div",{id:"comparisonSection",className:"comparison-section hidden",children:[(0,a.jsxs)("div",{className:"comparison-header",children:[(0,a.jsx)("h3",{children:"\uD83D\uDCC8 Period Comparison"}),(0,a.jsx)("button",{id:"hideComparison",className:"close-comparison-btn",children:"✕"})]}),(0,a.jsxs)("div",{className:"comparison-controls",children:[(0,a.jsxs)("div",{className:"comparison-periods",children:[(0,a.jsxs)("div",{className:"period-selector",children:[(0,a.jsx)("h4",{children:"Period A"}),(0,a.jsxs)("div",{className:"period-inputs",children:[(0,a.jsx)("input",{type:"date",id:"periodAStart",className:"date-input"}),(0,a.jsx)("span",{children:"to"}),(0,a.jsx)("input",{type:"date",id:"periodAEnd",className:"date-input"})]}),(0,a.jsxs)("div",{className:"period-presets",children:[(0,a.jsx)("button",{className:"preset-btn","data-period":"A","data-days":"7",children:"Last 7 days"}),(0,a.jsx)("button",{className:"preset-btn","data-period":"A","data-days":"30",children:"Last 30 days"})]})]}),(0,a.jsxs)("div",{className:"period-selector",children:[(0,a.jsx)("h4",{children:"Period B (Compare to)"}),(0,a.jsxs)("div",{className:"period-inputs",children:[(0,a.jsx)("input",{type:"date",id:"periodBStart",className:"date-input"}),(0,a.jsx)("span",{children:"to"}),(0,a.jsx)("input",{type:"date",id:"periodBEnd",className:"date-input"})]}),(0,a.jsxs)("div",{className:"period-presets",children:[(0,a.jsx)("button",{className:"preset-btn","data-period":"B","data-days":"7",children:"Previous 7 days"}),(0,a.jsx)("button",{className:"preset-btn","data-period":"B","data-days":"30",children:"Previous 30 days"})]})]})]}),(0,a.jsx)("button",{id:"runComparison",className:"run-comparison-btn",children:"Run Comparison"})]}),(0,a.jsxs)("div",{id:"comparisonResults",className:"comparison-results hidden",children:[(0,a.jsx)("div",{className:"comparison-summary",children:(0,a.jsxs)("div",{className:"period-info",children:[(0,a.jsxs)("div",{className:"period-card period-a",children:[(0,a.jsx)("h4",{children:"Period A"}),(0,a.jsx)("div",{className:"period-dates",id:"periodADates"}),(0,a.jsx)("div",{className:"period-duration",id:"periodADuration"})]}),(0,a.jsxs)("div",{className:"period-card period-b",children:[(0,a.jsx)("h4",{children:"Period B"}),(0,a.jsx)("div",{className:"period-dates",id:"periodBDates"}),(0,a.jsx)("div",{className:"period-duration",id:"periodBDuration"})]})]})}),(0,a.jsxs)("div",{className:"comparison-metrics",children:[(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Total Requests"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compTotalRequestsA",children:"0"}),(0,a.jsx)("span",{className:"metric-b",id:"compTotalRequestsB",children:"0"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compTotalRequestsChange",children:"0%"})]}),(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Unique URLs"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compUniqueUrlsA",children:"0"}),(0,a.jsx)("span",{className:"metric-b",id:"compUniqueUrlsB",children:"0"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compUniqueUrlsChange",children:"0%"})]}),(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Bot Traffic"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compBotTrafficA",children:"0"}),(0,a.jsx)("span",{className:"metric-b",id:"compBotTrafficB",children:"0"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compBotTrafficChange",children:"0%"})]}),(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Human Traffic"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compHumanTrafficA",children:"0"}),(0,a.jsx)("span",{className:"metric-b",id:"compHumanTrafficB",children:"0"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compHumanTrafficChange",children:"0%"})]}),(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Total Bytes"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compTotalBytesA",children:"0"}),(0,a.jsx)("span",{className:"metric-b",id:"compTotalBytesB",children:"0"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compTotalBytesChange",children:"0%"})]}),(0,a.jsxs)("div",{className:"metric-card",children:[(0,a.jsx)("div",{className:"metric-label",children:"Error Rate"}),(0,a.jsxs)("div",{className:"metric-values",children:[(0,a.jsx)("span",{className:"metric-a",id:"compErrorRateA",children:"0%"}),(0,a.jsx)("span",{className:"metric-b",id:"compErrorRateB",children:"0%"})]}),(0,a.jsx)("div",{className:"metric-change",id:"compErrorRateChange",children:"0%"})]})]}),(0,a.jsxs)("div",{className:"comparison-charts",children:[(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Daily Traffic Comparison"})}),(0,a.jsx)("canvas",{id:"comparisonTrafficChart"})]}),(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Bot vs Human Traffic Comparison"})}),(0,a.jsx)("canvas",{id:"comparisonBotChart"})]})]}),(0,a.jsxs)("div",{className:"comparison-tables",children:[(0,a.jsxs)("div",{className:"comparison-table-container",children:[(0,a.jsxs)("div",{className:"chart-header",children:[(0,a.jsx)("h3",{children:"\uD83E\uDD16 Bot Hits per URL - Comparison"}),(0,a.jsx)("div",{className:"comparison-table-controls",children:(0,a.jsxs)("div",{className:"multiselect-dropdown",id:"compBotFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"compBotFilterDisplay",children:"Select Bots"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"compBotFilterOptions",children:[(0,a.jsxs)("div",{className:"multiselect-actions",children:[(0,a.jsx)("button",{className:"filter-action-btn","data-action":"select-all",children:"Select All"}),(0,a.jsx)("button",{className:"filter-action-btn","data-action":"deselect-all",children:"Deselect All"})]}),(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"compBotFilterSearch",className:"multiselect-search-input",placeholder:"Search bots..."})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"compBotFilterCheckboxes"})]})]})})]}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"comparisonBotHitsTable",children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{})]})})]}),(0,a.jsxs)("div",{className:"comparison-table-container",children:[(0,a.jsxs)("div",{className:"chart-header",children:[(0,a.jsx)("h3",{children:"\uD83D\uDC65 Human Traffic Sources - Comparison"}),(0,a.jsx)("div",{className:"comparison-table-controls",children:(0,a.jsxs)("div",{className:"multiselect-dropdown",id:"compReferrerFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"compReferrerFilterDisplay",children:"Select Referrers"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"compReferrerFilterOptions",children:[(0,a.jsxs)("div",{className:"multiselect-actions",children:[(0,a.jsx)("button",{className:"filter-action-btn","data-action":"select-all",children:"Select All"}),(0,a.jsx)("button",{className:"filter-action-btn","data-action":"deselect-all",children:"Deselect All"})]}),(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"compReferrerFilterSearch",className:"multiselect-search-input",placeholder:"Search referrers..."})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"compReferrerFilterCheckboxes"})]})]})})]}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"comparisonTrafficSourcesTable",children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{})]})})]})]})]})]}),(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Unique URLs"}),(0,a.jsx)("div",{className:"stat-value",id:"uniqueUrls",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Unique URLs / day"}),(0,a.jsx)("div",{className:"stat-value",id:"uniqueUrlsPerDay",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Total events"}),(0,a.jsx)("div",{className:"stat-value",id:"totalEvents",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Events / day"}),(0,a.jsx)("div",{className:"stat-value",id:"eventsPerDay",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Total bytes"}),(0,a.jsx)("div",{className:"stat-value",id:"totalBytes",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Average bytes"}),(0,a.jsx)("div",{className:"stat-value",id:"avgBytes",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Bytes per day"}),(0,a.jsx)("div",{className:"stat-value",id:"bytesPerDay",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Success (2xx)"}),(0,a.jsx)("div",{className:"stat-value",id:"successCount",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Redirection (3xx)"}),(0,a.jsx)("div",{className:"stat-value",id:"redirectionCount",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Client Error (4xx)"}),(0,a.jsx)("div",{className:"stat-value",id:"clientErrorCount",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Server Error (5xx)"}),(0,a.jsx)("div",{className:"stat-value",id:"serverErrorCount",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Errors"}),(0,a.jsx)("div",{className:"stat-value",id:"errorCount",children:"0"})]})]}),(0,a.jsxs)("div",{className:"bot-analysis-section",children:[(0,a.jsx)("h2",{children:"\uD83E\uDD16 Bot & Crawler Analysis"}),(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Total Bot Requests"}),(0,a.jsx)("div",{className:"stat-value",id:"totalBotRequests",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Bot Traffic %"}),(0,a.jsx)("div",{className:"stat-value",id:"botTrafficPercentage",children:"0%"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Unique Bots"}),(0,a.jsx)("div",{className:"stat-value",id:"uniqueBots",children:"0"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Human Traffic %"}),(0,a.jsx)("div",{className:"stat-value",id:"humanTrafficPercentage",children:"0%"})]})]}),(0,a.jsxs)("div",{className:"bot-categories",children:[(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83D\uDD0D SEO & Search Engine Bots"}),(0,a.jsx)("span",{className:"bot-category-count",id:"seoBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"seoBotsList"})]}),(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83E\uDDE0 AI & Machine Learning Bots"}),(0,a.jsx)("span",{className:"bot-category-count",id:"aiBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"aiBotsList"})]}),(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83D\uDCF1 Social Media Bots"}),(0,a.jsx)("span",{className:"bot-category-count",id:"socialBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"socialBotsList"})]}),(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83D\uDCCA Monitoring & Analytics Bots"}),(0,a.jsx)("span",{className:"bot-category-count",id:"monitoringBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"monitoringBotsList"})]}),(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83D\uDD12 Security & Vulnerability Scanners"}),(0,a.jsx)("span",{className:"bot-category-count",id:"securityBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"securityBotsList"})]}),(0,a.jsxs)("div",{className:"bot-category",children:[(0,a.jsxs)("div",{className:"bot-category-header",children:[(0,a.jsx)("h3",{className:"bot-category-title",children:"\uD83D\uDD27 Other Bots & Tools"}),(0,a.jsx)("span",{className:"bot-category-count",id:"otherBotsCount",children:"0 requests"})]}),(0,a.jsx)("div",{className:"bot-list",id:"otherBotsList"})]})]})]}),(0,a.jsxs)("div",{className:"charts-section",children:[(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Response Codes Over Time"})}),(0,a.jsx)("canvas",{id:"responseCodesChart"})]}),(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Daily Events"})}),(0,a.jsx)("canvas",{id:"eventsChart"})]}),(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Bot Activity Over Time"})}),(0,a.jsx)("canvas",{id:"botActivityChart"})]}),(0,a.jsxs)("div",{className:"table-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Top URLs"})}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"topUrlsTable",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"URL"}),(0,a.jsx)("th",{children:"Hits"}),(0,a.jsx)("th",{children:"Percentage"})]})}),(0,a.jsx)("tbody",{})]})})]}),(0,a.jsxs)("div",{className:"chart-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Top Bots Distribution"})}),(0,a.jsx)("canvas",{id:"botDistributionChart"})]}),(0,a.jsxs)("div",{className:"table-container",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Bot Details"})}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"botDetailsTable",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Bot Name"}),(0,a.jsx)("th",{children:"Type"}),(0,a.jsx)("th",{children:"Requests"}),(0,a.jsx)("th",{children:"Percentage"}),(0,a.jsx)("th",{children:"Last Seen"})]})}),(0,a.jsx)("tbody",{})]})})]}),(0,a.jsxs)("div",{className:"interactive-table-card full-width",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Bot Hits per URL"})}),(0,a.jsx)("div",{className:"bot-filter-controls",children:(0,a.jsxs)("div",{className:"multiselect-dropdown",id:"botUrlFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"botUrlFilterDisplay",children:"Select Bots"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"botUrlFilterOptions",children:[(0,a.jsxs)("div",{className:"multiselect-actions",children:[(0,a.jsx)("button",{className:"filter-action-btn","data-action":"select-all",children:"Select All"}),(0,a.jsx)("button",{className:"filter-action-btn","data-action":"deselect-all",children:"Deselect All"})]}),(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"botFilterSearch",className:"multiselect-search-input",placeholder:"Search bots..."})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"botUrlFilterCheckboxes"})]})]})}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"botUrlHitsTable",children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{})]})})]}),(0,a.jsxs)("div",{className:"interactive-table-card full-width",children:[(0,a.jsx)("div",{className:"chart-header",children:(0,a.jsx)("h3",{children:"Human Traffic Sources"})}),(0,a.jsx)("div",{className:"bot-filter-controls",children:(0,a.jsxs)("div",{className:"multiselect-dropdown",id:"referrerFilterDropdown",children:[(0,a.jsx)("div",{className:"multiselect-display",id:"referrerFilterDisplay",children:"Select Referrers"}),(0,a.jsxs)("div",{className:"multiselect-options",id:"referrerFilterOptions",children:[(0,a.jsxs)("div",{className:"multiselect-actions",children:[(0,a.jsx)("button",{className:"filter-action-btn","data-action":"select-all",children:"Select All"}),(0,a.jsx)("button",{className:"filter-action-btn","data-action":"deselect-all",children:"Deselect All"})]}),(0,a.jsx)("div",{className:"multiselect-search-container",children:(0,a.jsx)("input",{type:"text",id:"referrerFilterSearch",className:"multiselect-search-input",placeholder:"Search referrers..."})}),(0,a.jsx)("div",{className:"multiselect-checkboxes",id:"referrerFilterCheckboxes"})]})]})}),(0,a.jsx)("div",{className:"table-wrapper",children:(0,a.jsxs)("table",{id:"trafficSourceTable",children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{})]})})]})]})]}),(0,a.jsx)("div",{id:"rejectionModal",className:"modal-overlay hidden",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h3",{children:"Exclude URL Prefixes"}),(0,a.jsx)("button",{id:"closeRejectionModal",className:"modal-close-btn",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"modal-body",children:[(0,a.jsxs)("p",{children:["Enter any URL prefixes you wish to exclude from the analysis. For example, entering",(0,a.jsx)("code",{children:"/wp-json/"})," will ignore all requests to that path."]}),(0,a.jsxs)("div",{id:"rejectionRulesContainer",children:[(0,a.jsxs)("div",{className:"rejection-rule-row",children:[(0,a.jsx)("input",{type:"text",placeholder:"/path/to/exclude/",defaultValue:"/wp-"}),(0,a.jsx)("button",{className:"remove-rule-btn",children:"−"})]}),(0,a.jsxs)("div",{className:"rejection-rule-row",children:[(0,a.jsx)("input",{type:"text",placeholder:"/path/to/exclude/",defaultValue:"/robots.txt"}),(0,a.jsx)("button",{className:"remove-rule-btn",children:"−"})]}),(0,a.jsxs)("div",{className:"rejection-rule-row",children:[(0,a.jsx)("input",{type:"text",placeholder:"/path/to/exclude/",defaultValue:"/sitemaps.xml"}),(0,a.jsx)("button",{className:"remove-rule-btn",children:"−"})]})]}),(0,a.jsx)("button",{id:"addRejectionRule",className:"add-rule-btn",children:"+ Add Rule"})]}),(0,a.jsxs)("div",{className:"modal-footer",children:[(0,a.jsx)("button",{id:"analyzeWithoutRejection",className:"modal-btn secondary",children:"Analyze Without Filtering"}),(0,a.jsx)("button",{id:"confirmRejectionAndAnalyze",className:"modal-btn primary",children:"Apply Filters & Analyze"})]})]})})]})})}))},8813:()=>{}},e=>{e.O(0,[26,647,568,441,255,120],()=>e(e.s=3431)),_N_E=e.O()}]);